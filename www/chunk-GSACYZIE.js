import{Q as se,T as ce,Y as de,Z as ge,a as ie,b as be,p as ne,q as oe,u as re,v as le}from"./chunk-DC72OUVS.js";import{a as ae,b as pe}from"./chunk-NRZIFRM7.js";import{A as x,C as D,Cb as L,Db as M,Eb as B,F as p,Fb as q,Gb as N,Hb as $,J as c,K as t,Kb as W,L as e,M as f,Pb as j,Qa as O,Qb as A,R as b,S as _,Ta as P,Ub as J,Vb as z,Zb as H,_b as V,aa as r,ab as R,ba as T,bc as K,ca as g,cb as F,da as w,ea as y,fa as E,fc as U,ga as S,gc as Y,mc as G,na as me,oc as X,pa as v,qa as I,sc as Z,ta as C,tc as ee,ua as k,ub as Q,uc as te,z as l}from"./chunk-MUBZYPCN.js";import"./chunk-IUOEA5VS.js";import"./chunk-GG6GQ6ON.js";import"./chunk-HKEYXBPG.js";import"./chunk-65VMTP75.js";import"./chunk-DKYB3LAM.js";import"./chunk-WKMV7HP7.js";import"./chunk-2CQGC6XC.js";import"./chunk-MOTUYE2F.js";import"./chunk-7BGE4CD4.js";import"./chunk-Z3ZIDQ56.js";import"./chunk-TRVT55KM.js";import"./chunk-NLP2MHHW.js";import"./chunk-KFF2YPXM.js";import"./chunk-VX62UQSI.js";import"./chunk-5R267MUJ.js";import{f as ue,h as m}from"./chunk-ECACSZ36.js";function _e(i,s){if(i&1&&(t(0,"ion-select-option",22),r(1),e()),i&2){let n=s.$implicit;c("value",n.name),l(),g(" ",n.name," ")}}function he(i,s){if(i&1&&(t(0,"ion-item")(1,"ion-label")(2,"h3"),r(3),e(),t(4,"p"),r(5),e()()()),i&2){let n=s.$implicit;l(3),T(n.name),l(2),w("",n.type," ",n.notnull?"(NOT NULL)":""," ",n.pk?"(PK)":"")}}function fe(i,s){if(i&1&&(t(0,"th",30),r(1),e()),i&2){let n=s.$implicit;l(),g(" ",n," ")}}function xe(i,s){if(i&1&&(t(0,"td",32),r(1),e()),i&2){let n=s.$implicit,a=_().$implicit,d=_(3);l(),g(" ",d.formatValue(a[n])," ")}}function ye(i,s){if(i&1&&(t(0,"tr"),p(1,xe,2,1,"td",31),e()),i&2){let n=_(3);l(),c("ngForOf",n.getColumns())}}function Ee(i,s){if(i&1&&(t(0,"div",27)(1,"table",28)(2,"thead")(3,"tr"),p(4,fe,2,1,"th",29),e()(),t(5,"tbody"),p(6,ye,2,1,"tr",25),e()()()),i&2){let n=_(2);l(4),c("ngForOf",n.getColumns()),l(2),c("ngForOf",n.tableData)}}function Se(i,s){i&1&&(t(0,"p",33),r(1," Nenhum dado encontrado nesta tabela "),e())}function De(i,s){if(i&1&&(t(0,"div",23)(1,"h3"),r(2,"Estrutura da Tabela"),e(),t(3,"ion-list",24),p(4,he,6,4,"ion-item",25),e(),t(5,"h3",23),r(6),e(),p(7,Ee,7,2,"div",26)(8,Se,2,0,"p",20),e()),i&2){let n=_();l(4),c("ngForOf",n.tableStructure),l(2),g(" Dados (",(n.tableData==null?null:n.tableData.length)||0," registros) "),l(),c("ngIf",n.tableData&&n.tableData.length>0),l(),c("ngIf",!n.tableData||n.tableData.length===0)}}function Te(i,s){if(i&1&&(t(0,"th",30),r(1),e()),i&2){let n=s.$implicit;l(),g(" ",n," ")}}function we(i,s){if(i&1&&(t(0,"td",32),r(1),e()),i&2){let n=s.$implicit,a=_().$implicit,d=_(2);l(),g(" ",d.formatValue(a[n])," ")}}function ve(i,s){if(i&1&&(t(0,"tr"),p(1,we,2,1,"td",31),e()),i&2){let n=s.$implicit,a=_(2);l(),c("ngForOf",a.Object.keys(n))}}function Ie(i,s){if(i&1&&(t(0,"div",23)(1,"h3"),r(2),e(),t(3,"div",27)(4,"table",28)(5,"thead")(6,"tr"),p(7,Te,2,1,"th",29),e()(),t(8,"tbody"),p(9,ve,2,1,"tr",25),e()()()()),i&2){let n=_();l(2),g("Resultado (",n.queryResult.length," registros)"),l(5),c("ngForOf",n.Object.keys(n.queryResult[0])),l(2),c("ngForOf",n.queryResult)}}function Ce(i,s){i&1&&(t(0,"p",33),r(1," Nenhum resultado encontrado "),e())}var $e,ke=ue(()=>{k();F();te();be();ge();me();pe();te();k();F();$e=(()=>{let s=class s{constructor(a,d){this.databaseService=a,this.toastController=d,this.tables=[],this.selectedTable="",this.tableData=null,this.tableStructure=[],this.customQuery="",this.queryResult=null,this.databasePath="",this.backupInfo="",this.Object=Object,ie({download:le,refreshOutline:se,trashOutline:de,cloudDownloadOutline:ne,documentTextOutline:re,searchOutline:ce,codeSlashOutline:oe})}ngOnInit(){return m(this,null,function*(){yield this.loadTables(),yield this.loadDatabaseInfo()})}loadTables(){return m(this,null,function*(){try{let a=yield this.databaseService.query("SELECT name FROM sqlite_master WHERE type='table' ORDER BY name");this.tables=a.values||[],this.tables.length>0&&!this.selectedTable&&(this.selectedTable=this.tables[0].name,yield this.loadTableData())}catch(a){console.error("Error loading tables:",a),yield this.showToast("Erro ao carregar tabelas","danger")}})}loadDatabaseInfo(){return m(this,null,function*(){try{this.databasePath=yield this.databaseService.getDatabasePath();let a=localStorage.getItem("meuapp_db_backup"),d=localStorage.getItem("meuapp_db_backup_timestamp");if(a){let o=(a.length/1024).toFixed(2);this.backupInfo=`Backup dispon\xEDvel: ${o} KB (${d})`}else this.backupInfo="Nenhum backup dispon\xEDvel"}catch(a){console.error("Error loading database info:",a)}})}onTableChange(){return m(this,null,function*(){this.selectedTable&&(yield this.loadTableData())})}loadTableData(){return m(this,null,function*(){try{let a=yield this.databaseService.query(`PRAGMA table_info(${this.selectedTable})`);this.tableStructure=a.values||[];let d=yield this.databaseService.query(`SELECT * FROM ${this.selectedTable} LIMIT 100`);this.tableData=d.values||[]}catch(a){console.error("Error loading table data:",a),yield this.showToast("Erro ao carregar dados da tabela","danger")}})}executeCustomQuery(){return m(this,null,function*(){if(!this.customQuery.trim()){yield this.showToast("Digite uma query SQL","warning");return}try{let a=yield this.databaseService.query(this.customQuery);this.queryResult=a.values||[],yield this.showToast("Query executada com sucesso","success")}catch(a){console.error("Error executing query:",a),yield this.showToast(`Erro: ${a.message}`,"danger"),this.queryResult=null}})}downloadAsJson(){return m(this,null,function*(){try{yield this.databaseService.downloadDatabaseAsJson(),yield this.showToast("Banco exportado como JSON","success")}catch(a){console.error("Error exporting as JSON:",a),yield this.showToast("Erro ao exportar banco","danger")}})}downloadAsSQLite(){return m(this,null,function*(){try{yield this.databaseService.downloadDatabaseAsSQLite(),yield this.showToast("Banco exportado como SQLite","success")}catch(a){console.error("Error exporting as SQLite:",a),yield this.showToast("Erro ao exportar banco","danger")}})}clearBackup(){return m(this,null,function*(){try{this.databaseService.clearLocalStorageBackup(),yield this.loadDatabaseInfo(),yield this.showToast("Backup limpo com sucesso","success")}catch(a){console.error("Error clearing backup:",a),yield this.showToast("Erro ao limpar backup","danger")}})}refresh(a){return m(this,null,function*(){yield this.loadTables(),yield this.loadDatabaseInfo(),a&&a.target.complete()})}getColumns(){return!this.tableData||this.tableData.length===0?[]:Object.keys(this.tableData[0])}formatValue(a){return a==null?"(null)":typeof a=="object"?JSON.stringify(a,null,2):String(a)}showToast(a,d="primary"){return m(this,null,function*(){yield(yield this.toastController.create({message:a,duration:2e3,position:"bottom",color:d})).present()})}};s.\u0275fac=function(d){return new(d||s)(x(ae),x(G))},s.\u0275cmp=D({type:s,selectors:[["app-database-debug"]],decls:79,vars:11,consts:[[3,"translucent"],["slot","start"],["defaultHref","/tabs/settings"],["slot","end"],[3,"click"],["slot","icon-only","name","refresh-outline"],[3,"fullscreen"],["slot","fixed",3,"ionRefresh"],[2,"margin-top","16px","display","flex","gap","8px","flex-wrap","wrap"],["size","small",3,"click"],["slot","start","name","document-text-outline"],["slot","start","name","cloud-download-outline"],["size","small","color","danger",3,"click"],["slot","start","name","trash-outline"],[3,"ngModelChange","ionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["style","margin-top: 16px;",4,"ngIf"],["placeholder","Digite sua query SQL aqui... Ex: SELECT * FROM users WHERE email LIKE '%@%'","rows","4",2,"border","1px solid #ddd","border-radius","4px","padding","8px","font-family","monospace",3,"ngModelChange","ngModel"],["expand","block",2,"margin-top","8px",3,"click"],["slot","start","name","search-outline"],["style","text-align: center; padding: 20px; color: #666;",4,"ngIf"],["button","",3,"click"],[3,"value"],[2,"margin-top","16px"],["lines","none"],[4,"ngFor","ngForOf"],["style","overflow-x: auto;",4,"ngIf"],[2,"overflow-x","auto"],[2,"width","100%","border-collapse","collapse","font-size","12px"],["style","border: 1px solid #ddd; padding: 8px; background-color: #f5f5f5; text-align: left;",4,"ngFor","ngForOf"],[2,"border","1px solid #ddd","padding","8px","background-color","#f5f5f5","text-align","left"],["style","border: 1px solid #ddd; padding: 8px; max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;",4,"ngFor","ngForOf"],[2,"border","1px solid #ddd","padding","8px","max-width","200px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap"],[2,"text-align","center","padding","20px","color","#666"]],template:function(d,o){d&1&&(t(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-buttons",1),f(3,"ion-back-button",2),e(),t(4,"ion-title"),r(5,"Debug do Banco de Dados"),e(),t(6,"ion-buttons",3)(7,"ion-button",4),b("click",function(){return o.refresh()}),f(8,"ion-icon",5),e()()()(),t(9,"ion-content",6)(10,"ion-refresher",7),b("ionRefresh",function(h){return o.refresh(h)}),f(11,"ion-refresher-content"),e(),t(12,"ion-card")(13,"ion-card-header")(14,"ion-card-title"),r(15,"Informa\xE7\xF5es do Banco"),e()(),t(16,"ion-card-content")(17,"p")(18,"strong"),r(19,"Caminho:"),e(),r(20),e(),t(21,"p")(22,"strong"),r(23,"Tabelas:"),e(),r(24),e(),t(25,"p")(26,"strong"),r(27,"Backup:"),e(),r(28),e(),t(29,"div",8)(30,"ion-button",9),b("click",function(){return o.downloadAsJson()}),f(31,"ion-icon",10),r(32," Exportar JSON "),e(),t(33,"ion-button",9),b("click",function(){return o.downloadAsSQLite()}),f(34,"ion-icon",11),r(35," Exportar SQLite "),e(),t(36,"ion-button",12),b("click",function(){return o.clearBackup()}),f(37,"ion-icon",13),r(38," Limpar Backup "),e()()()(),t(39,"ion-card")(40,"ion-card-header")(41,"ion-card-title"),r(42,"Visualizar Tabela"),e()(),t(43,"ion-card-content")(44,"ion-item")(45,"ion-label"),r(46,"Selecione a tabela"),e(),t(47,"ion-select",14),S("ngModelChange",function(h){return E(o.selectedTable,h)||(o.selectedTable=h),h}),b("ionChange",function(){return o.onTableChange()}),p(48,_e,2,2,"ion-select-option",15),e()(),p(49,De,9,4,"div",16),e()(),t(50,"ion-card")(51,"ion-card-header")(52,"ion-card-title"),r(53,"Query Personalizada"),e()(),t(54,"ion-card-content")(55,"ion-textarea",17),S("ngModelChange",function(h){return E(o.customQuery,h)||(o.customQuery=h),h}),e(),t(56,"ion-button",18),b("click",function(){return o.executeCustomQuery()}),f(57,"ion-icon",19),r(58," Executar Query "),e(),p(59,Ie,10,3,"div",16)(60,Ce,2,0,"p",20),e()(),t(61,"ion-card")(62,"ion-card-header")(63,"ion-card-title"),r(64,"Exemplos de Queries"),e()(),t(65,"ion-card-content")(66,"ion-list")(67,"ion-item",21),b("click",function(){return o.customQuery="SELECT * FROM users",o.executeCustomQuery()}),t(68,"ion-label"),r(69,"Ver todos os usu\xE1rios"),e()(),t(70,"ion-item",21),b("click",function(){return o.customQuery="SELECT * FROM tasks ORDER BY data_criacao DESC LIMIT 10",o.executeCustomQuery()}),t(71,"ion-label"),r(72,"10 tarefas mais recentes"),e()(),t(73,"ion-item",21),b("click",function(){return o.customQuery="SELECT status, COUNT(*) as count FROM tasks GROUP BY status",o.executeCustomQuery()}),t(74,"ion-label"),r(75,"Contagem de tarefas por status"),e()(),t(76,"ion-item",21),b("click",function(){return o.customQuery="SELECT name FROM sqlite_master WHERE type='table'",o.executeCustomQuery()}),t(77,"ion-label"),r(78,"Listar todas as tabelas"),e()()()()()()),d&2&&(c("translucent",!0),l(9),c("fullscreen",!0),l(11),g(" ",o.databasePath),l(4),g(" ",o.tables.length),l(4),g(" ",o.backupInfo),l(19),y("ngModel",o.selectedTable),l(),c("ngForOf",o.tables),l(),c("ngIf",o.selectedTable),l(6),y("ngModel",o.customQuery),l(4),c("ngIf",o.queryResult&&o.queryResult.length>0),l(),c("ngIf",o.queryResult!==null&&o.queryResult.length===0))},dependencies:[C,v,I,R,O,P,j,Y,U,W,z,A,J,B,N,$,q,L,M,Q,X,ee,Z,K,H,V],encapsulation:2});let i=s;return i})()});ke();export{$e as DatabaseDebugPage};
